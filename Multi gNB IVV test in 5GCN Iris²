Parfait  on passe en IVV avancé multi-gNB.
Objectif :
Simuler plusieurs gNodeB connectés au même 5GC pour tester :
·	Load AMF (N2 – NGAP/SCTP)
·	Multi-UPF (N3 – GTP-U)
·	Slice steering
·	Handover
·	Résilience
·	Scénarios NTN (latence différenciée par gNB)
Stack utilisée :
·	5GC : Open5GS
·	RAN Simulator : UERANSIM
 Architecture Multi-gNB
Exemple avec 3 gNB :
                +-------------------+                 |       AMF         |                 +---------+---------+                           |                           |      +--------------------+--------------------+      |                    |                    |    N2/N3                N2/N3               N2/N3      |                    |                    | +----+----+         +-----+----+         +-----+----+ | gNB-1  |         | gNB-2   |         | gNB-3   | +----+----+         +-----+----+         +-----+----+      |                    |                    |     UE1..UE50           UE51..100          UE101..150 
 Ce que tu vas tester

Test	Objectif
Multi-SCTP	Charge N2 AMF
Multi-GTP	Charge UPF
Slice steering	UPF différent par gNB
Handover	UE change de gNB
NTN	Latence différente par gNB
 Scaling simple Kubernetes
Si tu veux juste multiplier les gNB :
kubectl scale deployment gnb --replicas=3 -n ivv-5gc

 Mais ça réplique la même config → même gNB ID.
Il faut différencier chaque gNB.
 Version propre : 3 Deployments distincts
 gNB-1
apiVersion: apps/v1 kind: Deployment metadata:   name: gnb-1   namespace: ivv-5gc spec:   replicas: 1   selector:     matchLabels:       app: gnb-1   template:     metadata:       labels:         app: gnb-1     spec:       containers:       - name: gnb         image: ghcr.io/aligungr/UERANSIM:latest         command: ["./nr-gnb"]         args: ["-c", "/config/gnb.yaml"]         volumeMounts:         - name: config           mountPath: /config       volumes:       - name: config         configMap:           name: gnb1-config 
 ConfigMap gNB-1
apiVersion: v1
kind: ConfigMap
metadata:
  name: gnb1-config
  namespace: ivv-5gc
data:
  gnb.yaml: |
    mcc: "208"
    mnc: "93"
    gnbId: 1
    amfConfigs:
      - address: open5gs
        port: 38412
    gtpIp: gnb-1

 gNB-2
Même chose mais :
gnbId: 2
gtpIp: gnb-2

 gNB-3
gnbId: 3
gtpIp: gnb-3

 Répartir les UE par gNB
Dans chaque ue.yaml :
gnbSearchList:
  - gnb-1

ou
gnbSearchList:
  - gnb-2







 Tests IVV Multi-gNB
 Test 1 — Vérifier 3 connexions N2
Dans logs AMF :
NG Setup Request from gNB-1
NG Setup Request from gNB-2
NG Setup Request from gNB-3

Tu dois voir 3 associations SCTP.
 Test 2 — Charge AMF
Augmente les UE :
kubectl scale deployment ue --replicas=100

Observer :
·	CPU AMF
·	Sessions actives
·	Rejet éventuel
 Test 3 — Multi-UPF par slice
Configurer 2 UPF :
·	UPF-Civil
·	UPF-Gov
Puis dans SMF :
S-NSSAI 1 → UPF-Civil
S-NSSAI 2 → UPF-Gov

Ensuite :
·	gNB-1 → Civil
·	gNB-2 → Gov
·	gNB-3 → Mix
 Test 4 — Handover simulé
Changer dynamiquement dans UE :
gnbSearchList:
  - gnb-2

Redémarrer UE.
Observer :
·	UE Context Release
·	New Initial UE Message
·	PDU Session Update
 Multi-gNB + NTN (cas IRIS2)
Tu peux simuler :
gNB	Type
gNB-1	Terrestre
gNB-2	LEO 40 ms
gNB-3	GEO 600 ms
Dans pod gNB-3 :
tc qdisc add dev eth0 root netem delay 600ms

Tester :
·	Retransmission NGAP
·	Stability PDU
·	QoS degradation
 Monitoring recommandé
Surveiller :
·	SCTP associations
·	GTP tunnels actifs
·	CPU AMF
·	CPU UPF
·	UE Registered
·	Packet loss NTN
 Version Opérateur avancée
Si tu veux vraiment du lourd :
·	2 AMF replicas
·	3 UPF (edge)
·	10 gNB simulés
·	1000 UE
·	Slice isolation
·	NetworkPolicy Kubernetes
·	HPA automatique
·	Injection panne AMF
 Question pour toi
Tu veux :
1.	 10 gNB + 1000 UE stress test ?
2.	 Multi-gNB avec LEO + GEO + Terrestre ?
3.	 Slice Gov / Défense / Civil isolés ?
4.	 Scénario handover massif automatisé ?
Dis-moi ton objectif exact (R&D, pré-prod, IRIS2, stress test opérateur) et je te monte une version calibrée 
